(()=>{"use strict";var __webpack_modules__={174:()=>{eval('\n;// CONCATENATED MODULE: ./src/components/Card.js\nclass Card {\n  constructor(\n    config,\n    card,\n    handleCardClick,\n    deleteCardFromServer,\n    userId,\n    handleLikeCard,\n    handleDislikeCard,\n    handleGetLikes\n  ) {\n    this._config = config;\n    this._card = card;\n    this._name = card.name;\n    this._link = card.link;\n    this._handleCardClick = handleCardClick;\n    this._deleteCardFromServer = deleteCardFromServer;\n    this._handleLikeCard = handleLikeCard;\n    this._handleDislikeCard = handleDislikeCard;\n    this._userId = userId;\n  }\n\n  _getTemplate() {\n    return document\n      .querySelector(this._config.placeTemplate)\n      .content.children[0].cloneNode(true);\n  }\n\n  _addEventListeners() {\n    this._view\n      .querySelector(this._config.cardDeleteButton)\n      .addEventListener("click", (evt) => {\n        this._deleteCard(this._card);\n      });\n    this._placeImage.addEventListener("click", () => {\n      this._handleCardClick(this._name, this._link);\n    });\n    this._buttonLike.addEventListener("click", () => {\n      this._changeLikeStatus();\n    });\n  }\n\n  _deleteCard() {\n    this._deleteCardFromServer(this._card._id, this._view);\n  }\n\n  _checkOwner(template) {\n    if (this._userId !== this._card.owner._id) {\n      template.querySelector(this._config.cardDeleteButton).style.display =\n        "none";\n    }\n    return template;\n  }\n\n  _changeLikeStatus() {\n    const isLiked = this._card.likes.some((user) => user._id === this._userId);\n    if (isLiked) {\n      this._handleDislikeCard(this._card._id).then((res) => {\n        console.log(res);\n        this._view.querySelector(this._config.cardLikes).textContent =\n          res.likes.length;\n        this._card.likes = res.likes;\n      });\n    } else {\n      this._handleLikeCard(this._card._id).then((res) => {\n        this._view.querySelector(this._config.cardLikes).textContent =\n          res.likes.length;\n        this._card.likes = res.likes;\n      });\n    }\n    this._buttonLike.classList.toggle("place__like-button_active");\n  }\n\n  _checkInitialOwnerLike() {\n    if (this._card.likes.some((user) => user._id === this._userId)) {\n      this._buttonLike.classList.add("place__like-button_active");\n    }\n  }\n\n  _setLikes() {\n    this._view.querySelector(this._config.cardLikes).textContent =\n      this._card.likes.length;\n  }\n\n  render() {\n    this._view = this._checkOwner(this._getTemplate());\n    this._placeName = this._view.querySelector(this._config.cardName);\n    this._placeName.textContent = this._name;\n    this._placeImage = this._view.querySelector(this._config.cardImage);\n    this._placeImage.src = this._link;\n    this._placeImage.alt = this._name;\n    this._buttonLike = this._view.querySelector(this._config.cardLikeButton);\n    this._setLikes();\n    this._checkInitialOwnerLike();\n    this._addEventListeners();\n\n    return this._view;\n  }\n}\n\n/* harmony default export */ const components_Card = (Card);\n\n;// CONCATENATED MODULE: ./src/components/FormValidator.js\nclass FormValidator {\n  constructor(config, formElement) {\n    this._formElement = formElement;\n    this._inputElement = config.inputSelector;\n    this._submitButtonSelector = config.submitButtonSelector;\n    this._submitButtonElement = formElement.querySelector(\n      this._submitButtonSelector\n    );\n    this._inputErrorClass = config.inputErrorClass;\n    this._errorClass = config.errorClass;\n    this._inputList = Array.from(\n      this._formElement.querySelectorAll(this._inputElement)\n    );\n  }\n\n  _activateError(inputElement) {\n    this._errorElement = this._formElement.querySelector(\n      `.${inputElement.id}-error`\n    );\n    inputElement.classList.add(this._inputErrorClass);\n    this._errorElement.textContent = inputElement.validationMessage;\n    this._errorElement.classList.add(this._errorClass);\n  }\n\n  _disableError(inputElement) {\n    this._errorElement = this._formElement.querySelector(\n      `.${inputElement.id}-error`\n    );\n    inputElement.classList.remove(this._inputErrorClass);\n    this._errorElement.classList.remove(this._errorClass);\n    this._errorElement.textContent = "";\n  }\n\n  _checkInputValidity(inputElement) {\n    if (!inputElement.validity.valid) {\n      this._activateError(inputElement);\n    } else {\n      this._disableError(inputElement);\n    }\n  }\n\n  _deactivateButton() {\n    if (this._submitButtonElement) {\n      this._submitButtonElement.setAttribute("disabled", true);\n    }\n  }\n\n  _activateButton() {\n    if (this._submitButtonElement) {\n      this._submitButtonElement.removeAttribute("disabled", true);\n    }\n  }\n\n  _toggleButtonState() {\n    if (this._hasInvalidInput(this._inputList)) {\n      this._deactivateButton(this._submitButtonElement);\n    } else {\n      this._activateButton(this._submitButtonElement);\n    }\n  }\n\n  _setEventListeners() {\n    this._inputList.forEach((inputElement) => {\n      inputElement.addEventListener("input", () => {\n        this._checkInputValidity(inputElement);\n        this._toggleButtonState();\n      });\n    });\n  }\n\n  enableValidation() {\n    this._setEventListeners();\n  }\n\n  _hasInvalidInput() {\n    return this._inputList.some((inputElement) => {\n      return !inputElement.validity.valid;\n    });\n  }\n\n  resetValidation() {\n    this._toggleButtonState();\n    this._inputList.forEach((inputElement) => {\n      this._disableError(inputElement);\n    });\n  }\n}\n\n/* harmony default export */ const components_FormValidator = (FormValidator);\n\n;// CONCATENATED MODULE: ./src/components/Section.js\nclass Section {\n  constructor({ renderer }, containerSelector) {\n    this._renderer = renderer;\n    this._container = document.querySelector(containerSelector);\n  }\n\n  addItem(element) {\n    this._container.prepend(element);\n  }\n\n  renderItems(items) {\n    items.forEach((item) => {\n      this._renderer(item);\n    });\n  }\n}\n\n/* harmony default export */ const components_Section = (Section);\n\n;// CONCATENATED MODULE: ./src/components/Popup.js\nclass Popup {\n  constructor(popupSelector) {\n    this._popupElement = document.querySelector(popupSelector);\n    this._closeButtonElement = this._popupElement.querySelector(\n      ".popup__close-button"\n    );\n    this._handleEscClose = this._handleEscClose.bind(this);\n  }\n  open() {\n    this._popupElement.classList.add("popup_isOpen");\n    document.addEventListener("keydown", this._handleEscClose);\n  }\n\n  close() {\n    this._popupElement.classList.remove("popup_isOpen");\n    document.removeEventListener("keydown", this._handleEscClose);\n  }\n\n  _handleEscClose(evt) {\n    if (evt.key === "Escape") {\n      this.close();\n    }\n  }\n\n  _handleButtonClick() {\n    if (this._popupElement.classList.contains("popup_isOpen")) {\n      this.close();\n    }\n  }\n\n  setEventListeners() {\n    this._closeButtonElement.addEventListener("click", () => {\n      this._handleButtonClick();\n    });\n    this._popupElement.addEventListener("mousedown", (evt) => {\n      if (evt.target.classList.contains("popup_isOpen")) {\n        this.close();\n      }\n    });\n  }\n}\n/* harmony default export */ const components_Popup = (Popup);\n\n;// CONCATENATED MODULE: ./src/components/PopupWithImage.js\n\nclass PopupWithImage extends components_Popup {\n  constructor(popupSelector) {\n    super(popupSelector);\n    this._imageElement = this._popupElement.querySelector(\n      ".popup__place-image"\n    );\n    this._nameElement = this._popupElement.querySelector(".popup__place-name");\n  }\n  open(placeName, placeLink) {\n    super.open();\n    this._imageElement.setAttribute("src", placeLink);\n    this._nameElement.textContent = placeName;\n    this._imageElement.setAttribute("alt", placeName);\n  }\n}\n\n/* harmony default export */ const components_PopupWithImage = (PopupWithImage);\n\n;// CONCATENATED MODULE: ./src/components/PopupWithForm.js\n\nclass PopupWithForm extends components_Popup {\n  constructor(popupSelector, handleFormSubmit, handleRenderLoading) {\n    super(popupSelector);\n    this._formElement = this._popupElement.querySelector(".popup__form");\n    this._inputs = this._formElement.querySelectorAll(".popup__input");\n    this._handleFormSubmit = handleFormSubmit;\n    this._submitButton = this._formElement.querySelector(\n      ".popup__submit-button"\n    );\n    this._handleRenderLoading = handleRenderLoading;\n  }\n\n  getInputValues() {\n    const inputValues = {};\n    this._inputs.forEach((item) => {\n      inputValues[item.name] = item.value;\n    });\n    return inputValues;\n  }\n\n  setEventListeners() {\n    super.setEventListeners();\n    this._formElement.addEventListener(\n      "submit",\n      this._handleFormSubmit.bind(this)\n    );\n  }\n  close() {\n    super.close();\n    this._formElement.reset();\n  }\n\n  setLoader() {\n    this._handleRenderLoading(true, this._submitButton);\n  }\n\n  removeLoader() {\n    this._handleRenderLoading(false, this._submitButton);\n  }\n}\n\n/* harmony default export */ const components_PopupWithForm = (PopupWithForm);\n\n;// CONCATENATED MODULE: ./src/components/PopupWithSubmit.js\n\n\nclass PopupWithSubmit extends components_Popup {\n  constructor(popupSelector, handleFormDelete) {\n    super(popupSelector);\n    this._handleFormDelete = handleFormDelete;\n    this._formElement = this._popupElement.querySelector(".popup__form");\n    this._submitButton = this._formElement.querySelector(\n      ".popup__submit-button"\n    );\n  }\n\n  setEventListeners() {\n    super.setEventListeners();\n    this._submitButton.addEventListener(\n      "click",\n      this._handleFormDelete.bind(this)\n    );\n  }\n\n  submitDelete() {}\n\n  open(id, card) {\n    super.open();\n    this._cardData = {};\n    this._cardData.id = id;\n    this._cardData.card = card;\n  }\n\n  getCardData() {\n    return this._cardData;\n  }\n}\n\n/* harmony default export */ const components_PopupWithSubmit = (PopupWithSubmit);\n\n;// CONCATENATED MODULE: ./src/components/UserInfo.js\nclass UserInfo {\n  constructor({ nameSelector, aboutSelector, avatarSelector }) {\n    this._name = document.querySelector(nameSelector);\n    this._about = document.querySelector(aboutSelector);\n    this._avatar = document.querySelector(avatarSelector);\n    this._id;\n  }\n\n  getUserInfo() {\n    const userData = {};\n    userData.name = this._name.textContent;\n    userData.about = this._about.textContent;\n    return userData;\n  }\n  setUserInfo({ name, about, avatar, _id }) {\n    this._name.textContent = name;\n    this._about.textContent = about;\n    this._avatar.src = avatar;\n    this._id = _id;\n  }\n}\n\n/* harmony default export */ const components_UserInfo = (UserInfo);\n\n;// CONCATENATED MODULE: ./src/utils/constants.js\nconst btnEdit = document.querySelector(".profile__edit-button");\nconst popupEditSelector = "#popup_edit";\n\nconst popupDeleteSelector = "#popup_delete";\n\nconst popupAvatarSelector = "#popup_avatar";\nconst btnAvatar = document.querySelector(".profile__avatar");\nconst formAvatar = document.querySelector("#form_avatar");\n\nconst nameSelector = ".profile__name";\nconst nameInput = document.querySelector(".popup__input_name");\nconst aboutSelector = ".profile__about";\nconst avatarSelector = ".profile__avatar";\nconst aboutInput = document.querySelector(".popup__input_about");\nconst formEdit = document.querySelector("#form_edit");\n\nconst btnAdd = document.querySelector(".profile__add-button");\nconst popupAddSelector = "#popup_add";\nconst formAdd = document.querySelector("#form_add");\nconst placeNameInputElement = document.querySelector(\n  ".popup__input_place"\n);\nconst placeImgLinkElement = document.querySelector(".popup__input_link");\nconst placePopupSelector = "#popup_place";\n\nconst config = {\n  placeTemplate: ".place-template",\n  cardName: ".place__name",\n  cardImage: ".place__image",\n  cardLikes: ".place__like-count",\n  cardList: ".elements",\n  cardDeleteButton: ".place__delete-button",\n  cardLikeButton: ".place__like-button",\n  host: "https://mesto.nomoreparties.co/v1/cohort-47",\n  token: "ad5a4fe9-6249-4900-9757-39fd298866ec",\n};\n\nconst validation = {\n  formSelector: ".popup__form",\n  inputSelector: ".popup__input",\n  submitButtonSelector: ".popup__submit-button",\n  inputErrorClass: "popup__input_error",\n  errorClass: "popup__input-error_active",\n};\n\n;// CONCATENATED MODULE: ./src/components/Api.js\nclass Api {\n  constructor(host, token) {\n    this._host = host;\n    this._token = token;\n\n    this._getJsonOrError = this._getJsonOrError.bind(this);\n    this._getHeaders = this._getHeaders.bind(this);\n  }\n\n  _getJsonOrError(res) {\n    if (res.ok) {\n      return res.json();\n    }\n    return Promise.reject(`Ошибка: ${res.status}`);\n  }\n\n  _getHeaders() {\n    return {\n      authorization: this._token,\n      "content-type": "application/json",\n    };\n  }\n\n  getCards() {\n    return fetch(`${this._host}/cards`, {\n      headers: this._getHeaders(),\n    }).then(this._getJsonOrError);\n  }\n\n  getUserInfoFromServer() {\n    return fetch(`${this._host}/users/me`, {\n      headers: this._getHeaders(),\n    }).then(this._getJsonOrError);\n  }\n\n  createCard(card) {\n    return fetch(`${this._host}/cards`, {\n      method: "POST",\n      headers: this._getHeaders(),\n      body: JSON.stringify({\n        name: card.name,\n        link: card.link,\n      }),\n    }).then(this._getJsonOrError);\n  }\n\n  deleteCard(id) {\n    return fetch(`${this._host}/cards/${id}`, {\n      method: "DELETE",\n      headers: this._getHeaders(),\n    }).then(this._getJsonOrError);\n  }\n\n  updateUserInfo({ name, about }) {\n    return fetch(`${this._host}/users/me`, {\n      method: "PATCH",\n      headers: this._getHeaders(),\n      body: JSON.stringify({\n        name: name,\n        about: about,\n      }),\n    }).then(this._getJsonOrError);\n  }\n\n  updateUserAvatar(link) {\n    return fetch(`${this._host}/users/me/avatar`, {\n      method: "PATCH",\n      headers: this._getHeaders(),\n      body: JSON.stringify({\n        avatar: link,\n      }),\n    }).then(this._getJsonOrError);\n  }\n\n  setLike(id) {\n    return fetch(`${this._host}/cards/${id}/likes`, {\n      method: "PUT",\n      headers: this._getHeaders(),\n    }).then(this._getJsonOrError);\n  }\n\n  deleteLike(id) {\n    return fetch(`${this._host}/cards/${id}/likes`, {\n      method: "DELETE",\n      headers: this._getHeaders(),\n    }).then(this._getJsonOrError);\n  }\n}\n\n/* harmony default export */ const components_Api = (Api);\n\n;// CONCATENATED MODULE: ./src/pages/index.js\n\n\n\n\n\n\n\n\n\n\n\n\nlet userId;\n\nconst api = new components_Api(config.host, config.token);\n\nfunction handlerFormEditSubmit(evt) {\n  evt.preventDefault();\n  popupEdit.setLoader();\n  const info = popupEdit.getInputValues();\n  api\n    .updateUserInfo(info)\n    .then((data) => {\n      userInfo.setUserInfo(data);\n    })\n    .then(() => popupEdit.close())\n    .catch((err) => console.log(err))\n    .finally(() => {\n      popupEdit.removeLoader();\n    });\n}\n\nconst handlerPlaceSubmit = (evt) => {\n  evt.preventDefault();\n  const placeInfo = popupAdd.getInputValues();\n  popupAdd.setLoader();\n  api\n    .createCard(placeInfo)\n    .then((item) => {\n      renderCard(item);\n    })\n    .then(() => {\n      popupAdd.close();\n    })\n    .catch((err) => console.log(err))\n    .finally(() => {\n      popupAdd.removeLoader();\n    });\n};\n\nfunction handleAvatarSubmit(evt) {\n  evt.preventDefault();\n  const avatarLink = popupAvatar.getInputValues();\n  popupAvatar.setLoader();\n  api\n    .updateUserAvatar(avatarLink.link)\n    .then((avatar) => {\n      userInfo.setUserInfo(avatar);\n    })\n    .then(() => {\n      popupAvatar.close();\n    })\n    .catch((err) => console.log(err))\n    .finally(() => {\n      popupAvatar.removeLoader();\n    });\n}\n\nconst userInfo = new components_UserInfo({\n  nameSelector: nameSelector,\n  aboutSelector: aboutSelector,\n  avatarSelector: avatarSelector,\n});\n\nfunction deleteCard({ id, card }) {\n  return api\n    .deleteCard(id)\n    .then(card.remove(), (card = null))\n    .catch((err) => console.log(err));\n}\n\nfunction handleFormDelete(evt) {\n  evt.preventDefault();\n  deleteCard(popupSubmit.getCardData());\n\n  popupSubmit.close();\n}\n\nfunction openDeletePopup(id, card) {\n  popupSubmit.open(id, card);\n}\n\nconst handleCardClick = (placeName, placeLink) => {\n  placePopup.open(placeName, placeLink);\n};\n\nfunction handleLikeCard(id) {\n  return api.setLike(id);\n}\n\nfunction handleDislikeCard(id) {\n  return api.deleteLike(id);\n}\n\nfunction createCard(item) {\n  const place = new components_Card(\n    config,\n    item,\n    handleCardClick,\n    openDeletePopup,\n    userId,\n    handleLikeCard,\n    handleDislikeCard\n  );\n  const cardElement = place.render();\n  return cardElement;\n}\n\nconst renderCard = (item) => {\n  const cardElement = createCard(item);\n  cardList.addItem(cardElement);\n};\n\nfunction handleRenderLoading(isLoading, submitButton) {\n  if (isLoading) {\n    submitButton.textContent = "Сохранение...";\n  } else {\n    if (submitButton.classList.contains("popup__submit-button_add")) {\n      submitButton.textContent = "Создать";\n    } else {\n      submitButton.textContent = "Сохранить";\n    }\n  }\n}\n\nconst cardList = new components_Section(\n  {\n    renderer: renderCard,\n  },\n  config.cardList\n);\n\nbtnEdit.addEventListener("click", function () {\n  popupEdit.open();\n\n  const userData = userInfo.getUserInfo();\n  nameInput.value = userData.name;\n  aboutInput.value = userData.about;\n  formEditValidation.resetValidation();\n});\n\nbtnAdd.addEventListener("click", function () {\n  popupAdd.open();\n  formAddValidation.resetValidation();\n});\n\nbtnAvatar.addEventListener("click", function () {\n  popupAvatar.open();\n  formAvatarValidation.resetValidation();\n});\n\nconst popupSubmit = new components_PopupWithSubmit(popupDeleteSelector, handleFormDelete);\npopupSubmit.setEventListeners();\n\nconst popupAvatar = new components_PopupWithForm(\n  popupAvatarSelector,\n  handleAvatarSubmit,\n  handleRenderLoading\n);\npopupAvatar.setEventListeners();\n\nconst popupEdit = new components_PopupWithForm(\n  popupEditSelector,\n  handlerFormEditSubmit,\n  handleRenderLoading\n);\npopupEdit.setEventListeners();\nconst popupAdd = new components_PopupWithForm(\n  popupAddSelector,\n  handlerPlaceSubmit,\n  handleRenderLoading\n);\npopupAdd.setEventListeners();\n\nconst formEditValidation = new components_FormValidator(validation, formEdit);\nformEditValidation.enableValidation();\nconst formAddValidation = new components_FormValidator(validation, formAdd);\nformAddValidation.enableValidation();\nconst formAvatarValidation = new components_FormValidator(validation, formAvatar);\nformAvatarValidation.enableValidation();\n\nconst placePopup = new components_PopupWithImage(placePopupSelector);\nplacePopup.setEventListeners();\n\nPromise.all([api.getUserInfoFromServer(), api.getCards()])\n  .then(([user, cards]) => {\n    userId = user._id;\n    userInfo.setUserInfo(user);\n\n    cardList.renderItems(cards);\n  })\n  .catch((err) => console.log(err));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFCQUFxQixrQkFBTztBQUM1QjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZUFBZTtBQUNqQjs7QUFFQSx3QkFBd0I7QUFDeEI7O0FBRUE7QUFDQSxFQUFFLGVBQWU7QUFDakIsRUFBRSxnQkFBZ0I7QUFDbEI7QUFDQSxDQUFDOztBQUVELHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsQ0FBQzs7QUFFRCwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBLENBQUM7O0FBRUQsd0JBQXdCLDBCQUFlLENBQUMsbUJBQW1CO0FBQzNEOztBQUVBLHdCQUF3Qix3QkFBYTtBQUNyQyxFQUFFLG1CQUFtQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxzQkFBc0Isd0JBQWE7QUFDbkMsRUFBRSxpQkFBaUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsd0JBQWE7QUFDbEMsRUFBRSxnQkFBZ0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsK0JBQStCLHdCQUFhLENBQUMsVUFBVSxFQUFFLFFBQVE7QUFDakU7QUFDQSw4QkFBOEIsd0JBQWEsQ0FBQyxVQUFVLEVBQUUsT0FBTztBQUMvRDtBQUNBLGlDQUFpQyx3QkFBYSxDQUFDLFVBQVUsRUFBRSxVQUFVO0FBQ3JFOztBQUVBLHVCQUF1Qix5QkFBYyxDQUFDLGtCQUFrQjtBQUN4RDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSCIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcz80MTJkIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcz85MjFlIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcz9jZjAxIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanM/MjFiNSIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzPzFkYjUiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzPzIyYzYiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanM/MmI5MSIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzPzFiZGQiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzP2M5ZDkiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9BcGkuanM/ZWQwNiIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcz80NTcwIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBjb25maWcsXG4gICAgY2FyZCxcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXG4gICAgZGVsZXRlQ2FyZEZyb21TZXJ2ZXIsXG4gICAgdXNlcklkLFxuICAgIGhhbmRsZUxpa2VDYXJkLFxuICAgIGhhbmRsZURpc2xpa2VDYXJkLFxuICAgIGhhbmRsZUdldExpa2VzXG4gICkge1xuICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLl9jYXJkID0gY2FyZDtcbiAgICB0aGlzLl9uYW1lID0gY2FyZC5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBjYXJkLmxpbms7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2RlbGV0ZUNhcmRGcm9tU2VydmVyID0gZGVsZXRlQ2FyZEZyb21TZXJ2ZXI7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcbiAgICB0aGlzLl9oYW5kbGVEaXNsaWtlQ2FyZCA9IGhhbmRsZURpc2xpa2VDYXJkO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5wbGFjZVRlbXBsYXRlKVxuICAgICAgLmNvbnRlbnQuY2hpbGRyZW5bMF0uY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgX2FkZEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3ZpZXdcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5jYXJkRGVsZXRlQnV0dG9uKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICAgIHRoaXMuX2RlbGV0ZUNhcmQodGhpcy5fY2FyZCk7XG4gICAgICB9KTtcbiAgICB0aGlzLl9wbGFjZUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XG4gICAgfSk7XG4gICAgdGhpcy5fYnV0dG9uTGlrZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5fY2hhbmdlTGlrZVN0YXR1cygpO1xuICAgIH0pO1xuICB9XG5cbiAgX2RlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZGVsZXRlQ2FyZEZyb21TZXJ2ZXIodGhpcy5fY2FyZC5faWQsIHRoaXMuX3ZpZXcpO1xuICB9XG5cbiAgX2NoZWNrT3duZXIodGVtcGxhdGUpIHtcbiAgICBpZiAodGhpcy5fdXNlcklkICE9PSB0aGlzLl9jYXJkLm93bmVyLl9pZCkge1xuICAgICAgdGVtcGxhdGUucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuY2FyZERlbGV0ZUJ1dHRvbikuc3R5bGUuZGlzcGxheSA9XG4gICAgICAgIFwibm9uZVwiO1xuICAgIH1cbiAgICByZXR1cm4gdGVtcGxhdGU7XG4gIH1cblxuICBfY2hhbmdlTGlrZVN0YXR1cygpIHtcbiAgICBjb25zdCBpc0xpa2VkID0gdGhpcy5fY2FyZC5saWtlcy5zb21lKCh1c2VyKSA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgICBpZiAoaXNMaWtlZCkge1xuICAgICAgdGhpcy5faGFuZGxlRGlzbGlrZUNhcmQodGhpcy5fY2FyZC5faWQpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgICB0aGlzLl92aWV3LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLmNhcmRMaWtlcykudGV4dENvbnRlbnQgPVxuICAgICAgICAgIHJlcy5saWtlcy5sZW5ndGg7XG4gICAgICAgIHRoaXMuX2NhcmQubGlrZXMgPSByZXMubGlrZXM7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQodGhpcy5fY2FyZC5faWQpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICB0aGlzLl92aWV3LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLmNhcmRMaWtlcykudGV4dENvbnRlbnQgPVxuICAgICAgICAgIHJlcy5saWtlcy5sZW5ndGg7XG4gICAgICAgIHRoaXMuX2NhcmQubGlrZXMgPSByZXMubGlrZXM7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5fYnV0dG9uTGlrZS5jbGFzc0xpc3QudG9nZ2xlKFwicGxhY2VfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfVxuXG4gIF9jaGVja0luaXRpYWxPd25lckxpa2UoKSB7XG4gICAgaWYgKHRoaXMuX2NhcmQubGlrZXMuc29tZSgodXNlcikgPT4gdXNlci5faWQgPT09IHRoaXMuX3VzZXJJZCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkxpa2UuY2xhc3NMaXN0LmFkZChcInBsYWNlX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgX3NldExpa2VzKCkge1xuICAgIHRoaXMuX3ZpZXcucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuY2FyZExpa2VzKS50ZXh0Q29udGVudCA9XG4gICAgICB0aGlzLl9jYXJkLmxpa2VzLmxlbmd0aDtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICB0aGlzLl92aWV3ID0gdGhpcy5fY2hlY2tPd25lcih0aGlzLl9nZXRUZW1wbGF0ZSgpKTtcbiAgICB0aGlzLl9wbGFjZU5hbWUgPSB0aGlzLl92aWV3LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLmNhcmROYW1lKTtcbiAgICB0aGlzLl9wbGFjZU5hbWUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX3BsYWNlSW1hZ2UgPSB0aGlzLl92aWV3LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLmNhcmRJbWFnZSk7XG4gICAgdGhpcy5fcGxhY2VJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX3BsYWNlSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9idXR0b25MaWtlID0gdGhpcy5fdmlldy5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5jYXJkTGlrZUJ1dHRvbik7XG4gICAgdGhpcy5fc2V0TGlrZXMoKTtcbiAgICB0aGlzLl9jaGVja0luaXRpYWxPd25lckxpa2UoKTtcbiAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX3ZpZXc7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnQgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dEVsZW1lbnQpXG4gICAgKTtcbiAgfVxuXG4gIF9hY3RpdmF0ZUVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2Rpc2FibGVFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9hY3RpdmF0ZUVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2Rpc2FibGVFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9kZWFjdGl2YXRlQnV0dG9uKCkge1xuICAgIGlmICh0aGlzLl9zdWJtaXRCdXR0b25FbGVtZW50KSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIF9hY3RpdmF0ZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudCkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICB9XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XG4gICAgICB0aGlzLl9kZWFjdGl2YXRlQnV0dG9uKHRoaXMuX3N1Ym1pdEJ1dHRvbkVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9hY3RpdmF0ZUJ1dHRvbih0aGlzLl9zdWJtaXRCdXR0b25FbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2Rpc2FibGVFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcbiIsImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b25FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfaXNPcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfaXNPcGVuXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVCdXR0b25DbGljaygpIHtcbiAgICBpZiAodGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX2lzT3BlblwiKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQnV0dG9uQ2xpY2soKTtcbiAgICB9KTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9pc09wZW5cIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLnBvcHVwX19wbGFjZS1pbWFnZVwiXG4gICAgKTtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19wbGFjZS1uYW1lXCIpO1xuICB9XG4gIG9wZW4ocGxhY2VOYW1lLCBwbGFjZUxpbmspIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNldEF0dHJpYnV0ZShcInNyY1wiLCBwbGFjZUxpbmspO1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gcGxhY2VOYW1lO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgcGxhY2VOYW1lKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCwgaGFuZGxlUmVuZGVyTG9hZGluZykge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRzID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLnBvcHVwX19zdWJtaXQtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX2hhbmRsZVJlbmRlckxvYWRpbmcgPSBoYW5kbGVSZW5kZXJMb2FkaW5nO1xuICB9XG5cbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJzdWJtaXRcIixcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQuYmluZCh0aGlzKVxuICAgICk7XG4gIH1cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xuICB9XG5cbiAgc2V0TG9hZGVyKCkge1xuICAgIHRoaXMuX2hhbmRsZVJlbmRlckxvYWRpbmcodHJ1ZSwgdGhpcy5fc3VibWl0QnV0dG9uKTtcbiAgfVxuXG4gIHJlbW92ZUxvYWRlcigpIHtcbiAgICB0aGlzLl9oYW5kbGVSZW5kZXJMb2FkaW5nKGZhbHNlLCB0aGlzLl9zdWJtaXRCdXR0b24pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuY2xhc3MgUG9wdXBXaXRoU3VibWl0IGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtRGVsZXRlKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybURlbGV0ZSA9IGhhbmRsZUZvcm1EZWxldGU7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucG9wdXBfX3N1Ym1pdC1idXR0b25cIlxuICAgICk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJjbGlja1wiLFxuICAgICAgdGhpcy5faGFuZGxlRm9ybURlbGV0ZS5iaW5kKHRoaXMpXG4gICAgKTtcbiAgfVxuXG4gIHN1Ym1pdERlbGV0ZSgpIHt9XG5cbiAgb3BlbihpZCwgY2FyZCkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9jYXJkRGF0YSA9IHt9O1xuICAgIHRoaXMuX2NhcmREYXRhLmlkID0gaWQ7XG4gICAgdGhpcy5fY2FyZERhdGEuY2FyZCA9IGNhcmQ7XG4gIH1cblxuICBnZXRDYXJkRGF0YSgpIHtcbiAgICByZXR1cm4gdGhpcy5fY2FyZERhdGE7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoU3VibWl0O1xuIiwiY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgYWJvdXRTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fYWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFib3V0U2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICAgIHRoaXMuX2lkO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgdXNlckRhdGEgPSB7fTtcbiAgICB1c2VyRGF0YS5uYW1lID0gdGhpcy5fbmFtZS50ZXh0Q29udGVudDtcbiAgICB1c2VyRGF0YS5hYm91dCA9IHRoaXMuX2Fib3V0LnRleHRDb250ZW50O1xuICAgIHJldHVybiB1c2VyRGF0YTtcbiAgfVxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0LCBhdmF0YXIsIF9pZCB9KSB7XG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xuICAgIHRoaXMuX2lkID0gX2lkO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xuIiwiZXhwb3J0IGNvbnN0IGJ0bkVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwRWRpdFNlbGVjdG9yID0gXCIjcG9wdXBfZWRpdFwiO1xuXG5leHBvcnQgY29uc3QgcG9wdXBEZWxldGVTZWxlY3RvciA9IFwiI3BvcHVwX2RlbGV0ZVwiO1xuXG5leHBvcnQgY29uc3QgcG9wdXBBdmF0YXJTZWxlY3RvciA9IFwiI3BvcHVwX2F2YXRhclwiO1xuZXhwb3J0IGNvbnN0IGJ0bkF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuZXhwb3J0IGNvbnN0IGZvcm1BdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm1fYXZhdGFyXCIpO1xuXG5leHBvcnQgY29uc3QgbmFtZVNlbGVjdG9yID0gXCIucHJvZmlsZV9fbmFtZVwiO1xuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X25hbWVcIik7XG5leHBvcnQgY29uc3QgYWJvdXRTZWxlY3RvciA9IFwiLnByb2ZpbGVfX2Fib3V0XCI7XG5leHBvcnQgY29uc3QgYXZhdGFyU2VsZWN0b3IgPSBcIi5wcm9maWxlX19hdmF0YXJcIjtcbmV4cG9ydCBjb25zdCBhYm91dElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfYWJvdXRcIik7XG5leHBvcnQgY29uc3QgZm9ybUVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm1fZWRpdFwiKTtcblxuZXhwb3J0IGNvbnN0IGJ0bkFkZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBwb3B1cEFkZFNlbGVjdG9yID0gXCIjcG9wdXBfYWRkXCI7XG5leHBvcnQgY29uc3QgZm9ybUFkZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybV9hZGRcIik7XG5leHBvcnQgY29uc3QgcGxhY2VOYW1lSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucG9wdXBfX2lucHV0X3BsYWNlXCJcbik7XG5leHBvcnQgY29uc3QgcGxhY2VJbWdMaW5rRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X2xpbmtcIik7XG5leHBvcnQgY29uc3QgcGxhY2VQb3B1cFNlbGVjdG9yID0gXCIjcG9wdXBfcGxhY2VcIjtcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgcGxhY2VUZW1wbGF0ZTogXCIucGxhY2UtdGVtcGxhdGVcIixcbiAgY2FyZE5hbWU6IFwiLnBsYWNlX19uYW1lXCIsXG4gIGNhcmRJbWFnZTogXCIucGxhY2VfX2ltYWdlXCIsXG4gIGNhcmRMaWtlczogXCIucGxhY2VfX2xpa2UtY291bnRcIixcbiAgY2FyZExpc3Q6IFwiLmVsZW1lbnRzXCIsXG4gIGNhcmREZWxldGVCdXR0b246IFwiLnBsYWNlX19kZWxldGUtYnV0dG9uXCIsXG4gIGNhcmRMaWtlQnV0dG9uOiBcIi5wbGFjZV9fbGlrZS1idXR0b25cIixcbiAgaG9zdDogXCJodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTQ3XCIsXG4gIHRva2VuOiBcImFkNWE0ZmU5LTYyNDktNDkwMC05NzU3LTM5ZmQyOTg4NjZlY1wiLFxufTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb24gPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fc3VibWl0LWJ1dHRvblwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxufTtcbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKGhvc3QsIHRva2VuKSB7XG4gICAgdGhpcy5faG9zdCA9IGhvc3Q7XG4gICAgdGhpcy5fdG9rZW4gPSB0b2tlbjtcblxuICAgIHRoaXMuX2dldEpzb25PckVycm9yID0gdGhpcy5fZ2V0SnNvbk9yRXJyb3IuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9nZXRIZWFkZXJzID0gdGhpcy5fZ2V0SGVhZGVycy5iaW5kKHRoaXMpO1xuICB9XG5cbiAgX2dldEpzb25PckVycm9yKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgX2dldEhlYWRlcnMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxuICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgfTtcbiAgfVxuXG4gIGdldENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9ob3N0fS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcbiAgICB9KS50aGVuKHRoaXMuX2dldEpzb25PckVycm9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvRnJvbVNlcnZlcigpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5faG9zdH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9nZXRIZWFkZXJzKCksXG4gICAgfSkudGhlbih0aGlzLl9nZXRKc29uT3JFcnJvcik7XG4gIH1cblxuICBjcmVhdGVDYXJkKGNhcmQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5faG9zdH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBjYXJkLm5hbWUsXG4gICAgICAgIGxpbms6IGNhcmQubGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fZ2V0SnNvbk9yRXJyb3IpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9ob3N0fS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcbiAgICB9KS50aGVuKHRoaXMuX2dldEpzb25PckVycm9yKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9ob3N0fS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2dldEpzb25PckVycm9yKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJBdmF0YXIobGluaykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9ob3N0fS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9nZXRKc29uT3JFcnJvcik7XG4gIH1cblxuICBzZXRMaWtlKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2hvc3R9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxuICAgIH0pLnRoZW4odGhpcy5fZ2V0SnNvbk9yRXJyb3IpO1xuICB9XG5cbiAgZGVsZXRlTGlrZShpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9ob3N0fS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcbiAgICB9KS50aGVuKHRoaXMuX2dldEpzb25PckVycm9yKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBcGk7XG4iLCJpbXBvcnQgXCIuLy4uL3BhZ2VzL2luZGV4LmNzc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhTdWJtaXQgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCB7XG4gIGluaXRpYWxDYXJkcyxcbiAgYnRuRWRpdCxcbiAgcG9wdXBFZGl0U2VsZWN0b3IsXG4gIG5hbWVTZWxlY3RvcixcbiAgbmFtZUlucHV0LFxuICBhYm91dFNlbGVjdG9yLFxuICBhdmF0YXJTZWxlY3RvcixcbiAgYWJvdXRJbnB1dCxcbiAgZm9ybUVkaXQsXG4gIGJ0bkFkZCxcbiAgcG9wdXBBZGRTZWxlY3RvcixcbiAgZm9ybUFkZCxcbiAgcGxhY2VOYW1lSW5wdXRFbGVtZW50LFxuICBwbGFjZUltZ0xpbmtFbGVtZW50LFxuICBwbGFjZVBvcHVwU2VsZWN0b3IsXG4gIGNvbmZpZyxcbiAgdmFsaWRhdGlvbixcbiAgcG9wdXBEZWxldGVTZWxlY3RvcixcbiAgcG9wdXBBdmF0YXJTZWxlY3RvcixcbiAgYnRuQXZhdGFyLFxuICBmb3JtQXZhdGFyLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG5sZXQgdXNlcklkO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKGNvbmZpZy5ob3N0LCBjb25maWcudG9rZW4pO1xuXG5mdW5jdGlvbiBoYW5kbGVyRm9ybUVkaXRTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBwb3B1cEVkaXQuc2V0TG9hZGVyKCk7XG4gIGNvbnN0IGluZm8gPSBwb3B1cEVkaXQuZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJJbmZvKGluZm8pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4gcG9wdXBFZGl0LmNsb3NlKCkpXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcG9wdXBFZGl0LnJlbW92ZUxvYWRlcigpO1xuICAgIH0pO1xufVxuXG5jb25zdCBoYW5kbGVyUGxhY2VTdWJtaXQgPSAoZXZ0KSA9PiB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBwbGFjZUluZm8gPSBwb3B1cEFkZC5nZXRJbnB1dFZhbHVlcygpO1xuICBwb3B1cEFkZC5zZXRMb2FkZXIoKTtcbiAgYXBpXG4gICAgLmNyZWF0ZUNhcmQocGxhY2VJbmZvKVxuICAgIC50aGVuKChpdGVtKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKGl0ZW0pO1xuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgcG9wdXBBZGQuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHBvcHVwQWRkLnJlbW92ZUxvYWRlcigpO1xuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgYXZhdGFyTGluayA9IHBvcHVwQXZhdGFyLmdldElucHV0VmFsdWVzKCk7XG4gIHBvcHVwQXZhdGFyLnNldExvYWRlcigpO1xuICBhcGlcbiAgICAudXBkYXRlVXNlckF2YXRhcihhdmF0YXJMaW5rLmxpbmspXG4gICAgLnRoZW4oKGF2YXRhcikgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oYXZhdGFyKTtcbiAgICB9KVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHBvcHVwQXZhdGFyLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwb3B1cEF2YXRhci5yZW1vdmVMb2FkZXIoKTtcbiAgICB9KTtcbn1cblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IG5hbWVTZWxlY3RvcixcbiAgYWJvdXRTZWxlY3RvcjogYWJvdXRTZWxlY3RvcixcbiAgYXZhdGFyU2VsZWN0b3I6IGF2YXRhclNlbGVjdG9yLFxufSk7XG5cbmZ1bmN0aW9uIGRlbGV0ZUNhcmQoeyBpZCwgY2FyZCB9KSB7XG4gIHJldHVybiBhcGlcbiAgICAuZGVsZXRlQ2FyZChpZClcbiAgICAudGhlbihjYXJkLnJlbW92ZSgpLCAoY2FyZCA9IG51bGwpKVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRm9ybURlbGV0ZShldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGRlbGV0ZUNhcmQocG9wdXBTdWJtaXQuZ2V0Q2FyZERhdGEoKSk7XG5cbiAgcG9wdXBTdWJtaXQuY2xvc2UoKTtcbn1cblxuZnVuY3Rpb24gb3BlbkRlbGV0ZVBvcHVwKGlkLCBjYXJkKSB7XG4gIHBvcHVwU3VibWl0Lm9wZW4oaWQsIGNhcmQpO1xufVxuXG5jb25zdCBoYW5kbGVDYXJkQ2xpY2sgPSAocGxhY2VOYW1lLCBwbGFjZUxpbmspID0+IHtcbiAgcGxhY2VQb3B1cC5vcGVuKHBsYWNlTmFtZSwgcGxhY2VMaW5rKTtcbn07XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDYXJkKGlkKSB7XG4gIHJldHVybiBhcGkuc2V0TGlrZShpZCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURpc2xpa2VDYXJkKGlkKSB7XG4gIHJldHVybiBhcGkuZGVsZXRlTGlrZShpZCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSkge1xuICBjb25zdCBwbGFjZSA9IG5ldyBDYXJkKFxuICAgIGNvbmZpZyxcbiAgICBpdGVtLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBvcGVuRGVsZXRlUG9wdXAsXG4gICAgdXNlcklkLFxuICAgIGhhbmRsZUxpa2VDYXJkLFxuICAgIGhhbmRsZURpc2xpa2VDYXJkXG4gICk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gcGxhY2UucmVuZGVyKCk7XG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuY29uc3QgcmVuZGVyQ2FyZCA9IChpdGVtKSA9PiB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKTtcbiAgY2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XG59O1xuXG5mdW5jdGlvbiBoYW5kbGVSZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgc3VibWl0QnV0dG9uKSB7XG4gIGlmIChpc0xvYWRpbmcpIHtcbiAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcItCh0L7RhdGA0LDQvdC10L3QuNC1Li4uXCI7XG4gIH0gZWxzZSB7XG4gICAgaWYgKHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fc3VibWl0LWJ1dHRvbl9hZGRcIikpIHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwi0KHQvtC30LTQsNGC0YxcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCLQodC+0YXRgNCw0L3QuNGC0YxcIjtcbiAgICB9XG4gIH1cbn1cblxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICB9LFxuICBjb25maWcuY2FyZExpc3Rcbik7XG5cbmJ0bkVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgcG9wdXBFZGl0Lm9wZW4oKTtcblxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIG5hbWVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIGFib3V0SW5wdXQudmFsdWUgPSB1c2VyRGF0YS5hYm91dDtcbiAgZm9ybUVkaXRWYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbmJ0bkFkZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBwb3B1cEFkZC5vcGVuKCk7XG4gIGZvcm1BZGRWYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbmJ0bkF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBwb3B1cEF2YXRhci5vcGVuKCk7XG4gIGZvcm1BdmF0YXJWYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbmNvbnN0IHBvcHVwU3VibWl0ID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChwb3B1cERlbGV0ZVNlbGVjdG9yLCBoYW5kbGVGb3JtRGVsZXRlKTtcbnBvcHVwU3VibWl0LnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHBvcHVwQXZhdGFyU2VsZWN0b3IsXG4gIGhhbmRsZUF2YXRhclN1Ym1pdCxcbiAgaGFuZGxlUmVuZGVyTG9hZGluZ1xuKTtcbnBvcHVwQXZhdGFyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwRWRpdCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBwb3B1cEVkaXRTZWxlY3RvcixcbiAgaGFuZGxlckZvcm1FZGl0U3VibWl0LFxuICBoYW5kbGVSZW5kZXJMb2FkaW5nXG4pO1xucG9wdXBFZGl0LnNldEV2ZW50TGlzdGVuZXJzKCk7XG5jb25zdCBwb3B1cEFkZCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBwb3B1cEFkZFNlbGVjdG9yLFxuICBoYW5kbGVyUGxhY2VTdWJtaXQsXG4gIGhhbmRsZVJlbmRlckxvYWRpbmdcbik7XG5wb3B1cEFkZC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBmb3JtRWRpdFZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uLCBmb3JtRWRpdCk7XG5mb3JtRWRpdFZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xuY29uc3QgZm9ybUFkZFZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uLCBmb3JtQWRkKTtcbmZvcm1BZGRWYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcbmNvbnN0IGZvcm1BdmF0YXJWYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbiwgZm9ybUF2YXRhcik7XG5mb3JtQXZhdGFyVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IHBsYWNlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UocGxhY2VQb3B1cFNlbGVjdG9yKTtcbnBsYWNlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mb0Zyb21TZXJ2ZXIoKSwgYXBpLmdldENhcmRzKCldKVxuICAudGhlbigoW3VzZXIsIGNhcmRzXSkgPT4ge1xuICAgIHVzZXJJZCA9IHVzZXIuX2lkO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXIpO1xuXG4gICAgY2FyZExpc3QucmVuZGVySXRlbXMoY2FyZHMpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///174\n')}},__webpack_exports__={};__webpack_modules__[174]()})();