(()=>{"use strict";const e=class{constructor(e,t){this._formElement=t,this._inputElement=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._submitButtonElement=t.querySelector(this._submitButtonSelector),this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputElement))}_activateError(e){this._errorElement=this._formElement.querySelector(`.${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._errorClass)}_disableError(e){this._errorElement=this._formElement.querySelector(`.${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorElement.classList.remove(this._errorClass),this._errorElement.textContent=""}_checkInputValidity(e){e.validity.valid?this._disableError(e):this._activateError(e)}_deactivateButton(){this._submitButtonElement&&this._submitButtonElement.setAttribute("disabled",!0)}_activateButton(){this._submitButtonElement&&this._submitButtonElement.removeAttribute("disabled",!0)}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this._deactivateButton(this._submitButtonElement):this._activateButton(this._submitButtonElement)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._disableError(e)}))}},t=class{constructor(e){this._popupElement=document.querySelector(e),this._closeButtonElement=this._popupElement.querySelector(".popup__close-button")}open(){this._popupElement.classList.add("popup_isOpen")}close(){this._popupElement.classList.remove("popup_isOpen")}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleButtonClick(){this._popupElement.classList.contains("popup_isOpen")&&this.close()}setEventListeners(){this._closeButtonElement.addEventListener("click",(()=>{this._handleButtonClick()})),this._popupElement.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_isOpen")&&this.close()})),document.addEventListener("keydown",this._handleEscClose.bind(this))}},s=class extends t{constructor(e,t,s){super(e),this._popupElement=document.querySelector(e),this._imageElement=this._popupElement.querySelector(".popup__place-image"),this._nameElement=this._popupElement.querySelector(".popup__place-name"),this._name=t,this._link=s}open(){super.open(),this._imageElement.setAttribute("src",this._link),this._nameElement.textContent=this._name,this._imageElement.setAttribute("alt",this._name)}},n=class extends t{constructor(e,t){super(e),this._formElement=this._popupElement.querySelector(".popup__form"),this._inputs=this._formElement.querySelectorAll(".popup__input"),this._handleFormSubmit=t,this._submitButton=this._formElement.querySelector(".popup__submit-button")}getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._submitButton.addEventListener("click",this._handleFormSubmit.bind(this))}close(){super.close(),this._inputs.forEach((e=>{e.value=""})),"#popup_add"===this._popupSelector&&this._formElement.reset()}},i=document.querySelector(".profile__edit-button"),r=(document.querySelector(".profile__name"),document.querySelector(".popup__input_name")),o=(document.querySelector(".profile__about"),document.querySelector(".popup__input_about")),a=document.querySelector("#form_edit"),l=document.querySelector(".profile__add-button"),u=document.querySelector("#form_add"),c=document.querySelector(".popup__input_place"),p=document.querySelector(".popup__input_link"),_=(document.querySelectorAll(".popup"),{placeTemplate:".place-template",cardName:".place__name",cardImage:".place__image",cardList:".elements",cardDeleteButton:".place__delete-button",cardLikeButton:".place__like-button"}),m={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inputErrorClass:"popup__input_error",errorClass:"popup__input-error_active"},d=new class{constructor({nameSelector:e,aboutSelector:t}){this._name=document.querySelector(e),this._about=document.querySelector(t)}getUserInfo(){const e={};return e.name=this._name.textContent,e.about=this._about.textContent,e}setUserInfo({name:e,about:t}){this._name.textContent=e,this._about.textContent=t}}({nameSelector:".profile__name",aboutSelector:".profile__about"}),h=(e,t)=>{const n=new s("#popup_place",e,t);n.open(),n.setEventListeners()},E=e=>{const t=new class{constructor(e,t,s,n){this._config=e,this._name=t,this._image=s,this._handleCardClick=n}_getTemplate(){return document.querySelector(this._config.placeTemplate).content.children[0].cloneNode(!0)}_addEventListeners(){this._view.querySelector(this._config.cardDeleteButton).addEventListener("click",(e=>{this._deleteCard(e)})),this._placeImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._image)})),this._buttonLike.addEventListener("click",(()=>{this._likeCard()}))}_deleteCard(e){e.preventDefault(),this._view.remove(),this._view=null}_likeCard(){this._buttonLike.classList.toggle("place__like-button_active")}render(){return this._view=this._getTemplate(),this._placeName=this._view.querySelector(this._config.cardName),this._placeName.textContent=this._name,this._placeImage=this._view.querySelector(this._config.cardImage),this._placeImage.src=this._image,this._placeImage.alt=this._name,this._buttonLike=this._view.querySelector(this._config.cardLikeButton),this._addEventListeners(),this._view}}(_,e.name,e.link,h).render();v.addItem(t)},v=new class{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:E},_.cardList);v.renderItems(),i.addEventListener("click",(function(){b.open();const e=d.getUserInfo();r.value=e.name,o.value=e.about,S.resetValidation()})),l.addEventListener("click",(function(){y.open(),c.value="",p.value="",f.resetValidation()}));const b=new n("#popup_edit",(function(e){e.preventDefault();const t=b.getInputValues();d.setUserInfo(t),b.close()}));b.setEventListeners();const y=new n("#popup_add",(e=>{e.preventDefault();const t=c.value,s=p.value,n={};n.name=t,n.link=s,E(n),y.close()}));y.setEventListeners();const S=new e(m,a);S.enableValidation();const f=new e(m,u);f.enableValidation()})();